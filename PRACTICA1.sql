

CREATE TABLE PROFESION 
(
 cod_prof INTEGER PRIMARY KEY,
NOMBRE VARCHAR(50) NOT NULL ,
CONSTRAINT U14 UNIQUE(NOMBRE)
);

CREATE TABLE PAIS 
(
COD_PAIS INTEGER PRIMARY KEY,
nombre VARCHAR(50) NOT NULL, 
CONSTRAINT U1 UNIQUE(NOMBRE)
);

CREATE TABLE PUESTO
(
cod_puesto INTEGER PRIMARY KEY, 
nombre VARCHAR(50) NOT NULL,
CONSTRAINT U10 UNIQUE(NOMBRE)
);

CREATE TABLE DEPARTAMENTO
(
cod_depto INTEGER PRIMARY KEY, 
nombre VARCHAR(50) NOT NULL,
CONSTRAINT U2 UNIQUE(NOMBRE)
);


CREATE TABLE MIEMBRO
(
COD_MIEMBRO INTEGER PRIMARY KEY, 
NOMBRE VARCHAR(100) NOT NULL,
APELLIDO VARCHAR(100) NOT NULL,
EDAD INTEGER NOT NULL,
TELEFONO INTEGER NOT NULL,
RESIDENCIA VARCHAR(100) NOT NULL, 
PAIS_COD_PAIS INTEGER NOT NULL,
PROFESION_COD_PROF INTEGER NOT NULL,
CONSTRAINT FK1 FOREIGN KEY (PAIS_COD_PAIS) REFERENCES PAIS(COD_PAIS) ON DELETE CASCADE,
CONSTRAINT FK2 FOREIGN KEY (PROFESION_COD_PROF) REFERENCES PROFESION(COD_PROF)  ON DELETE CASCADE
);

CREATE TABLE PUESTO_MIEMBRO 
(
MIEMBRO_COD_MIEMBRO INTEGER NOT NULL, 
PUESTO_COD_PUESTO INTEGER NOT NULL, 
DEPARTAMENTO_COD_DEPTO INTEGER NOT NULL,
	CONSTRAINT PF1 PRIMARY KEY (MIEMBRO_COD_MIEMBRO, PUESTO_COD_PUESTO, DEPARTAMENTO_COD_DEPTO),
	CONSTRAINT FK3 FOREIGN KEY (MIEMBRO_COD_MIEMBRO) REFERENCES MIEMBRO(COD_MIEMBRO) ON DELETE CASCADE,
	CONSTRAINT FK4 FOREIGN KEY (PUESTO_COD_PUESTO) REFERENCES PUESTO(COD_PUESTO) ON DELETE CASCADE,
	CONSTRAINT FK5 FOREIGN KEY (DEPARTAMENTO_COD_DEPTO) REFERENCES DEPARTAMENTO(COD_DEPTO) ON DELETE CASCADE
);

CREATE TABLE TIPO_MEDALLA 
(
  COD_TIPO INTEGER PRIMARY KEY, 
  MEDALLA VARCHAR(50) NOT NULL,
  CONSTRAINT U3 UNIQUE(MEDALLA)
);

CREATE TABLE MEDALLERO
(
PAIS_COD_PAIS INTEGER NOT NULL, 
CANTIDAD_MEDALLAS INTEGER NOT NULL, 
TIPO_MEDALLA_COD_TIPO INTEGER NOT NULL,
CONSTRAINT PF2 PRIMARY KEY(PAIS_COD_PAIS,TIPO_MEDALLA_COD_TIPO),
CONSTRAINT FK6 FOREIGN KEY(PAIS_COD_PAIS) REFERENCES PAIS(COD_PAIS) ON DELETE CASCADE,
CONSTRAINT FK7 FOREIGN KEY(TIPO_MEDALLA_COD_TIPO) REFERENCES TIPO_MEDALLA(COD_TIPO)  ON DELETE CASCADE
);

CREATE TABLE DISCIPLINA
(
COD_DISCIPLINA INTEGER PRIMARY KEY,
NOMBRE VARCHAR(50) NOT NULL,
DESCRIPCION VARCHAR(150)
);

CREATE TABLE ATLETA
(
COD_ATLETA INTEGER PRIMARY KEY, 
NOMBRE VARCHAR(50 )NOT NULL,
APELLIDO VARCHAR(50) NOT NULL, 
EDAD INTEGER NOT NULL, 
PARTICIPACINES VARCHAR(100) NOT NULL,
DISCIPLINA_COD_DISCIPLINA INTEGER NOT NULL,
PAIS_COD_PAIS INTEGER NOT NULL,
CONSTRAINT FK8 FOREIGN KEY(DISCIPLINA_COD_DISCIPLINA) REFERENCES DISCIPLINA(COD_DISCIPLINA)  ON DELETE CASCADE,
CONSTRAINT FK9 FOREIGN KEY(PAIS_COD_PAIS) REFERENCES PAIS(COD_PAIS)  ON DELETE CASCADE
);

CREATE TABLE CATEGORIA 
(
COD_CATEGORIA INTEGER PRIMARY KEY,
CATEGORIA VARCHAR(50) NOT NULL
);

CREATE TABLE TIPO_PARTICIPACION 
(
COD_PARTICIPACION INTEGER PRIMARY KEY,
TIPO_PARTICIPACION VARCHAR(100) NOT NULL

);

CREATE TABLE EVENTO
(
    COD_EVENTO INTEGER PRIMARY KEY, 
    FECHA DATE NOT NULL,
    UBICACION VARCHAR(50) NOT NULL, 
    HORA DATE NOT NULL, 
    DISCIPLINA_COD_DISCIPLINA INTEGER NOT NULL,
    TIPO_PARTICIPACION_COD_PARTICIPACION INTEGER NOT NULL,
    CATEGORIA_COD_CATEGORIA INTEGER NOT NULL, 
    CONSTRAINT FK10 FOREIGN KEY (DISCIPLINA_COD_DISCIPLINA) REFERENCES DISCIPLINA(COD_DISCIPLINA)  ON DELETE CASCADE,
    CONSTRAINT FK11 FOREIGN KEY (TIPO_PARTICIPACION_COD_PARTICIPACION) REFERENCES TIPO_PARTICIPACION(COD_PARTICIPACION)  ON DELETE CASCADE,
    CONSTRAINT FK12 FOREIGN KEY (CATEGORIA_COD_CATEGORIA) REFERENCES CATEGORIA(COD_CATEGORIA)  ON DELETE CASCADE
);

CREATE TABLE EVENTO_ATLETA 
(
ATLETA_COD_ATLETA INTEGER NOT NULL, 
EVENTO_COD_EVENTO INTEGER NOT NULL,
CONSTRAINT P1 PRIMARY KEY (ATLETA_COD_ATLETA,EVENTO_COD_EVENTO),
CONSTRAINT FK13 FOREIGN KEY (ATLETA_COD_ATLETA) REFERENCES ATLETA(COD_ATLETA)  ON DELETE CASCADE,
CONSTRAINT FK14 FOREIGN KEY (EVENTO_COD_EVENTO) REFERENCES EVENTO(COD_EVENTO)  ON DELETE CASCADE
);

CREATE TABLE TELEVISORA 
(
COD_TELEVISORA INTEGER PRIMARY KEY, 
NOMBRE VARCHAR(100) NOT NULL
);

CREATE TABLE COSTO_EVENTO
(
EVENTO_COD_EVENTO INTEGER NOT NULL,
TELEVISORA_COD_TELEVISORA INTEGER NOT NULL,
TARIFA FLOAT NOT NULL,
CONSTRAINT P2 PRIMARY KEY (EVENTO_COD_EVENTO,TELEVISORA_COD_TELEVISORA),
CONSTRAINT FK15 FOREIGN KEY (EVENTO_COD_EVENTO) REFERENCES EVENTO(COD_EVENTO)  ON DELETE CASCADE,
CONSTRAINT FK16 FOREIGN KEY (TELEVISORA_COD_TELEVISORA) REFERENCES TELEVISORA(COD_TELEVISORA)  ON DELETE CASCADE
    
    
);

\dt;
-- FIN DEL SCRIPT 1

-- SCRIPT NUMERO 2 DE ENUNCIADO 
ALTER TABLE EVENTO DROP COLUMN FECHA;
ALTER TABLE EVENTO DROP COLUMN HORA;

ALTER TABLE EVENTO ADD FECHA_HORA TIMESTAMP NOT NULL; 
--FIN DEL SCRIPT 2

-- SCRIPT NUMERO 3 DE ENUNCIADO 
ALTER TABLE EVENTO ADD CONSTRAINT VERIFICARFECHA CHECK ((FECHA_HORA>='2020/07/24 09:00:00') AND (FECHA_HORA<='2020/08/09 20:00:00'));
--FIN DEL SCRIPT 3 
-- SCRIPT NUMERO 4 DEL ENUNCIADO 
CREATE TABLE SEDE 
(
CODIGO INTEGER PRIMARY KEY, 
SEDE VARCHAR(50) NOT NULL
);

ALTER TABLE EVENTO ALTER COLUMN UBICACION SET DATA TYPE INTEGER USING UBICACION::INTEGER;
ALTER TABLE EVENTO ADD CONSTRAINT FK50 FOREIGN KEY (UBICACION) REFERENCES SEDE(CODIGO) ON DELETE CASCADE;


--FIN SCRIPT 4 

--INICIO SCRIPT 5
ALTER TABLE MIEMBRO ALTER COLUMN TELEFONO set DEFAULT 0;
--FIN SCRIPT 5 

--INICIO SCRIPT 6
--INSERCION DE DATOS EN LA TABLA PAIS 
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (1,'GUATEMALA');
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (2,'FRANCIA');
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (3,'ARGENTINA');
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (4,'ALEMANIA');
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (5,'ITALIA');
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (6,'BRASIL');
INSERT INTO PAIS(COD_PAIS,NOMBRE) VALUES (7,'ESTADOS UNIDOS');
select * from pais;

--INCERSION PARA LOS DATOS EN LA TABLA PROFESION
INSERT INTO PROFESION(COD_PROF, NOMBRE) VALUES (1,'MÉDICO');
INSERT INTO PROFESION(COD_PROF, NOMBRE) VALUES (2,'ARQUITECTO');
INSERT INTO PROFESION(COD_PROF, NOMBRE) VALUES (3,'INGENIERO');
INSERT INTO PROFESION(COD_PROF, NOMBRE) VALUES (4,'SECRETARIA');
INSERT INTO PROFESION(COD_PROF, NOMBRE) VALUES (5,'AUDITOR');

select * from profesion;

--INCERSION DE DATOS EN LA TABLA MIEMBROS 
INSERT INTO MIEMBRO(COD_MIEMBRO,NOMBRE,APELLIDO,EDAD,TELEFONO,RESIDENCIA, PAIS_COD_PAIS,PROFESION_COD_PROF) 
VALUES (1,'SCOTT','MITCHELL',32,0,'1092 Highland Drive Manitowoc, WI 54220',7,3);
INSERT INTO MIEMBRO(COD_MIEMBRO,NOMBRE,APELLIDO,EDAD,TELEFONO,RESIDENCIA, PAIS_COD_PAIS,PROFESION_COD_PROF) 
VALUES (2,'FANETTE','POULIN',25,25075853,'49, boulevard Aristide Briand 76120 LE GRAND-QUEVILLY',2,4);
INSERT INTO MIEMBRO(COD_MIEMBRO,NOMBRE,APELLIDO,EDAD,TELEFONO,RESIDENCIA, PAIS_COD_PAIS,PROFESION_COD_PROF) 
VALUES (3,'LAURA','CUNHA SILVA',55,0,'RUA ONZE, 86 UBERABA-MG',6,5);
INSERT INTO MIEMBRO(COD_MIEMBRO,NOMBRE,APELLIDO,EDAD,TELEFONO,RESIDENCIA, PAIS_COD_PAIS,PROFESION_COD_PROF) 
VALUES (4,'JUAN JOSÉ','LOPEZ',38,36985247,'26 CALLE 4-10 ZONA 11',1,2);
INSERT INTO MIEMBRO(COD_MIEMBRO,NOMBRE,APELLIDO,EDAD,TELEFONO,RESIDENCIA, PAIS_COD_PAIS,PROFESION_COD_PROF) 
VALUES (5,'ARCANGELA','PANICUCCI',39,391664921,'VIA SANTA TERESA 114 90010-GERACIA SICULO PA',5,1);
INSERT INTO MIEMBRO(COD_MIEMBRO,NOMBRE,APELLIDO,EDAD,TELEFONO,RESIDENCIA, PAIS_COD_PAIS,PROFESION_COD_PROF) 
VALUES (6,'JEUEL','VILALPANDO',31,0,'ACUÑA DE FIGEROA 610680101 PLAYA PASCUAL',3,5);

select * from miembro;

--INCERSION DE DATOS EN LA TABLA DISCIPLINA 
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE,DESCRIPCION)VALUES(1,'ATLETISMO','SALTO DE LONGITUD Y TRIPLES, DE ALTURA Y CON PÉRTIGA Y GARROCHA; LAS PRUEBAS DE LANZAMIENTO DE MARTILLO, JABALINA Y DISCO.');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(2,'BADMINTON');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(3,'CICLISMO');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE,DESCRIPCION)VALUES(4,'JUDO','ES UN ARTE MARCIAL QUE SE ORIGINÓ EN JAPON ALREDEDOR DE 1880');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(5,'LUCHA');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(6,'TENIS DE MESA');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(7,'BOXEO');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE,DESCRIPCION)VALUES(8,'NATACION','Está presente como deporte en los Juegos desde la primera edición de la era moderna, en Atenas, Grecia, en 1896, donde se disputo en aguas abiertas.');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(9,'ESGRIMA');
INSERT INTO DISCIPLINA(COD_DISCIPLINA,NOMBRE)VALUES(10,'VELA');

select * from disciplina;
--INCERSION DE DATOS EN LA TABLA TIPO_MEDALLA 
INSERT INTO TIPO_MEDALLA(COD_TIPO,MEDALLA)VALUES(1,'ORO');
INSERT INTO TIPO_MEDALLA(COD_TIPO,MEDALLA)VALUES(2,'PLATA');
INSERT INTO TIPO_MEDALLA(COD_TIPO,MEDALLA)VALUES(3,'BRONCE');
INSERT INTO TIPO_MEDALLA(COD_TIPO,MEDALLA)VALUES(4,'PLATINO');
select * from tipo_medalla;
--INCERSION DE DATOS EN LA TABLA CATEGORIA 
INSERT INTO CATEGORIA(COD_CATEGORIA,CATEGORIA)VALUES(1,'CLASIFICATORIO');
INSERT INTO CATEGORIA(COD_CATEGORIA,CATEGORIA)VALUES(2,'ELIMINATORIO');
INSERT INTO CATEGORIA(COD_CATEGORIA,CATEGORIA)VALUES(3,'FINAL');
select * from categoria;
--INCERSINO DE DATOS EN LA TABLA TIPO PARTICIPACION 
INSERT INTO TIPO_PARTICIPACION(COD_PARTICIPACION,TIPO_PARTICIPACION)VALUES(1,'INDIVIDUAL');
INSERT INTO TIPO_PARTICIPACION(COD_PARTICIPACION,TIPO_PARTICIPACION)VALUES(2,'PAREJAS');
INSERT INTO TIPO_PARTICIPACION(COD_PARTICIPACION,TIPO_PARTICIPACION)VALUES(3,'EQUIPOS');
select * from tipo_participacion;
--INCERSION DE DATOS EN LA TABLA MEDALLERO
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(5,3,1);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(2,5,1);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(6,4,3);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(4,3,4);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(7,10,3);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(3,8,2);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(1,2,1);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(1,5,4);
INSERT INTO MEDALLERO(PAIS_COD_PAIS,CANTIDAD_MEDALLAS,TIPO_MEDALLA_COD_TIPO)VALUES(5,7,2);
select * from medallero;
--INCERSION DE DATOS EN LA TABLA SEDE 
INSERT INTO SEDE(CODIGO,SEDE)VALUES(1,'GIMNASIO METROPOLITANO DE TOKIO');
INSERT INTO SEDE(CODIGO,SEDE)VALUES(2,'JARDIN DEL PALACIO IMPERIAL DE TOKIO');
INSERT INTO SEDE(CODIGO,SEDE)VALUES(3,'GIMNASIO NACIONAL DE YOYOGI');
INSERT INTO SEDE(CODIGO,SEDE)VALUES(4,'NIPPON BUDOKAN');
INSERT INTO SEDE(CODIGO,SEDE)VALUES(5,'ESTADIO OLIMPICO');
select * from sede;
--INCERSION DE DATOS EN LA TABLA EVENTO 

INSERT INTO EVENTO (COD_EVENTO,FECHA_HORA,UBICACION,DISCIPLINA_COD_DISCIPLINA,TIPO_PARTICIPACION_COD_PARTICIPACION,CATEGORIA_COD_CATEGORIA)
VALUES (1,'2020/07/24 11:00:00',3,2,2,1);
INSERT INTO EVENTO (COD_EVENTO,FECHA_HORA,UBICACION,DISCIPLINA_COD_DISCIPLINA,TIPO_PARTICIPACION_COD_PARTICIPACION,CATEGORIA_COD_CATEGORIA)
VALUES (2,'2020/07/26 10:30:00',1,6,1,3);
INSERT INTO EVENTO (COD_EVENTO,FECHA_HORA,UBICACION,DISCIPLINA_COD_DISCIPLINA,TIPO_PARTICIPACION_COD_PARTICIPACION,CATEGORIA_COD_CATEGORIA)
VALUES (3,'2020/07/30 18:45:00',5,7,1,2);
INSERT INTO EVENTO (COD_EVENTO,FECHA_HORA,UBICACION,DISCIPLINA_COD_DISCIPLINA,TIPO_PARTICIPACION_COD_PARTICIPACION,CATEGORIA_COD_CATEGORIA)
VALUES (4,'2020/08/01 12:15:00',2,1,1,1);
INSERT INTO EVENTO (COD_EVENTO,FECHA_HORA,UBICACION,DISCIPLINA_COD_DISCIPLINA,TIPO_PARTICIPACION_COD_PARTICIPACION,CATEGORIA_COD_CATEGORIA)
VALUES (5,'2020/08/08 19:35:00',4,10,3,1);

select * from evento;

--FIN SCRIPT 6

--INICIO SCRIPT 7
ALTER TABLE PAIS
DROP CONSTRAINT U1;

ALTER TABLE TIPO_MEDALLA
DROP CONSTRAINT U3;

ALTER TABLE DEPARTAMENTO
DROP CONSTRAINT U2;


--FIN SCRIPT 7 

--INICIO SCRIPT 8
ALTER TABLE ATLETA DROP COLUMN DISCIPLINA_COD_DISCIPLINA; 

CREATE TABLE DISCIPLINA_ATLETA
(
COD_ATLETA INTEGER NOT NULL,
COD_DISCIPLINA INTEGER NOT NULL, 
CONSTRAINT PF4 PRIMARY KEY(COD_ATLETA,COD_DISCIPLINA) ,
CONSTRAINT FK47 FOREIGN KEY(COD_ATLETA) REFERENCES ATLETA(COD_ATLETA),
CONSTRAINT FK155 FOREIGN KEY(COD_DISCIPLINA) REFERENCES DISCIPLINA(COD_DISCIPLINA)

);
--FIN SCRIPT 8 

--INICIO DEL SCRIPT 9

ALTER TABLE COSTO_EVENTO ALTER COLUMN TARIFA SET DATA TYPE NUMERIC(5,2) USING TARIFA::NUMERIC(5,2);
--FIN DEL SCRIPT 9 

--INICIO DEL SCRIPT 10
DELETE FROM TIPO_MEDALLA WHERE COD_TIPO=4;
--FIN DEL SCRIPT 10

--INICIO DEL SCRIPT 11
DROP TABLE COSTO_EVENTO; 
DROP TABLE TELEVISORA ;
--FIN DEL SCRIPT 11


--INICIO DEL SCRIPT 12
DELETE FROM DISCIPLINA;
--FIN DEL SCRIPT 12 

--INICIO DEL SCRIPT 13
UPDATE MIEMBRO
SET TELEFONO = '55464601'
WHERE COD_MIEMBRO = 3;

UPDATE MIEMBRO
SET TELEFONO = '91514243'
WHERE COD_MIEMBRO=6;

UPDATE MIEMBRO
SET TELEFONO = '920686670'
WHERE COD_MIEMBRO = 1;
--FIN DEL SCRIPT 13

--INICIO DEL SCRIPT 14
ALTER TABLE ATLETA 
ADD COLUMN FOTOGRAFIA VARCHAR(1000);
--FIN DEL SCRIPT 14

--INICIO DEL SCRIPT 15
ALTER TABLE ATLETA ADD CONSTRAINT VERIFICAEDAD CHECK (EDAD<25);
--FIN DEL SCRIPT 15

